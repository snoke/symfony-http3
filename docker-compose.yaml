services:
  gateway:
    build: ./gateway
    environment:
      - RUST_LOG=info
      - WEBTRANSPORT_PORT=4433
      - HTTP_PORT=8080
    ports:
      # Gateway HTTP (health + internal info endpoint).
      - "8182:8080"
      # WebTransport runs over HTTP/3/QUIC (UDP). We map both TCP+UDP for convenience.
      - "8444:4433"
      - "8444:4433/udp"

  symfony:
    build: ./symfony
    environment:
      - APP_ENV=dev
      - APP_DEBUG=1
      - APP_SECRET=dev-secret
      - WT_URL=https://localhost:8444/
      - GATEWAY_HTTP_BASE_URL=http://gateway:8080
    ports:
      - "8183:8000"
